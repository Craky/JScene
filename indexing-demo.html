<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>JScene Demo</title>
<!-- Bootstrap -->
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="bootstrap/bootstrap.min.css">

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- https://dev.twitter.com/web/javascript/loading -->
<!-- Check out this handy way of embeddin tweets: https://dev.twitter.com/web/embedded-tweets/javascript-create -->
<script>
twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
</script>

<script type="text/javascript" src="db.js"></script>
<script type="text/javascript" src="index.js"></script>
<script type="text/javascript" src="search.js"></script>

<script type="text/javascript" src="tweets.js"></script></script>

<script>

function statsButton(e) {
  console.log("Getting stats...");

  var request1 = db.transaction(["postings"], "readonly")
                   .objectStore("postings").count();

  request1.onsuccess = function(e) {
    console.log("Total number of entries: " + e.target.result);
  }

  var request2 = db.transaction(["df"], "readonly")
                   .objectStore("df").count();

  request2.onsuccess = function(e) {
    console.log("Total number of terms: " + e.target.result);
  }
}

// http://stackoverflow.com/questions/5199901/how-to-sort-an-associative-array-by-its-values-in-javascript
function logResults(results, k) {
  var tuples = [];

  for (var key in results) tuples.push([key, results[key]]);

  tuples.sort(function(a, b) {
    return a[1] > b[1] ? -1 : (a[1] < b[1] ? 1 :
      a[0] < b[0] ? 1 : -1);
  });

  document.getElementById('results').innerHTML = "";

  for (var i = 0; i < k && i<tuples.length; i++) {
    console.log(tuples[i][0], tuples[i][1]);

twttr.widgets.createTweet(
  tuples[i][0],
  document.getElementById('results'),
  {}
);

  }
}

function indexButton() {
  console.log("Starting to index...");
  indexer.index(tweets);
}

function dfButton() {
  console.log("Starting to build df table...");
  indexer.buildDfTable(tweets);
}

searcher.setNumDocs(1128929);

</script>

<style>
body {
  padding-top: 50px;
}
</style>

</head>
<body>

  <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="./index.html">JScene</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="./index.html">Home</a></li>
            <li class="active"><a href="./indexing-demo.html">Indexing</a></li>
            <li><a href="./search-demo.html">Search</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

<div class="container"> 

<div class="page-header">
<h1>JScene <small>Indexing Demo</small></h1>
</div>

<p>The following demo builds the inverted index on my personal tweet
archive (1916 tweets through August 5, 2015) using IndexedDB:</p>

<p>
<button id="indexButton" onclick="indexButton()">Build Index</button>
<button id="dfButton" onclick="dfButton()">Build DF Table</button>

<button id="statsButton" onclick="statsButton()">Get Index Stats</button>
</p>

</div>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="bootstrap/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="bootstrap/ie10-viewport-bug-workaround.js"></script>

</body>
</html>
 


